{"version":3,"sources":["all.js","map.js"],"names":["apiUrl","app","Vue","el","data","area","disasterData","newList","pageList","showinfo","countOfPage","currPage","totalPages","nowPages","created","callData","computed","showPageList","vm","Math","ceil","length","start","end","forEach","item","i","push","methods","$http","get","then","response","body","DataSet","NewDataSet","CASE_SUMMARY","status","getList","window","name","initMap","selectData","CaseLocationDistrict","setPage","idx","reSetPage","map","google","maps","Map","document","getElementById","center","lat","lng","zoom","str","place","parseFloat","Wgs84Y","Wgs84X","title","Name","position","icon","Marker","$","hide","scroll","scrollTop","fadeIn","fadeOut","on","e","preventDefault","animate","offset","top"],"mappings":"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","file":"all.js","sourcesContent":["const apiUrl = 'https://tcgbusfs.blob.core.windows.net/blobfs/GetDisasterSummary.json'; //將apiUrl設定為常數不再變動。\r\n\r\nvar app = new Vue({\r\n  el: '#app',\r\n  data() {\r\n    return {\r\n      area: '全部',\r\n      disasterData: [], // 原始資料\r\n      newList: [], // 第一次整理後的資料\r\n      pageList: [], // 每頁的資料\r\n      showinfo: [],\r\n      countOfPage: 20, // 一頁顯示50筆\r\n      currPage: 1, // 當前頁數\r\n      totalPages: 0, // 總頁數的數字\r\n      nowPages: 0\r\n    }\r\n  },\r\n  created: function () {\r\n    //執行\r\n    this.callData()\r\n  },\r\n  computed: {\r\n    // 整理要顯示頁數的資料\r\n    showPageList: function () {\r\n      let vm = this;\r\n      vm.pageList = [];\r\n      // console.log(vm.newList,vm.pageList)\r\n      // 計算總頁數(無條件捨棄)=總資料/每頁顯示幾筆\r\n      vm.totalPages = Math.ceil(vm.newList.length / vm.countOfPage);\r\n      var start = vm.currPage * vm.countOfPage - vm.countOfPage;\r\n      var end = vm.currPage * vm.countOfPage;\r\n      // console.log(start,end,vm.totalPages); 0,10,X\r\n      vm.newList.forEach(function (item, i) {\r\n        // 0~9筆資料\r\n        if (i >= start && i < end) {\r\n          vm.pageList.push(item)\r\n        }\r\n      })\r\n      // console.log(vm.newList, vm.pageList);\r\n      return vm.pageList;\r\n    }\r\n  },\r\n  methods: {\r\n    callData: function () {\r\n      var vm = this;\r\n\r\n      // GET /someUrl\r\n      this.$http.get(apiUrl).then(response => {\r\n        // 獲取災害資訊，取得資料\r\n        vm.disasterData = response.body.DataSet['diffgr:diffgram'].NewDataSet.CASE_SUMMARY;\r\n        vm.showinfo = response.status;\r\n        vm.getList();\r\n        if (window.name === 'map'){\r\n          vm.initMap(vm.disasterData);\r\n        }\r\n      }, response => {\r\n        vm.showinfo = response.status;\r\n      });\r\n    },\r\n    // 整理剛得到的資料\r\n    getList: function () {\r\n      var vm = this;\r\n      vm.newList = [];\r\n      var selectData = vm.area;\r\n      // 篩選forEach寫法\r\n      if (selectData === '全部') {\r\n        vm.newList = vm.disasterData;\r\n      } else {\r\n        // item是陣列的內容元素,i是索引\r\n        vm.disasterData.forEach(function (item, i) {\r\n          if (item.CaseLocationDistrict == selectData) {\r\n            vm.newList.push(item)\r\n          }\r\n        });\r\n      }\r\n      // console.log(newList);\r\n      return vm.newList;\r\n\r\n    },\r\n    // 控制上下頁的變換\r\n    setPage: function (idx) {\r\n      // idx就是html的n\r\n      let vm = this;\r\n      if (idx <= 0 || idx > vm.totalPages) {\r\n        return;\r\n      }\r\n      vm.currPage = idx;\r\n    },\r\n    // 起始顯示的頁數\r\n    reSetPage: function () {\r\n      let vm = this;\r\n      vm.currPage = 1;\r\n    },\r\n    // Google Map API\r\n    initMap: function(data) {\r\n      // 設定中心點座標\r\n      var map = new google.maps.Map(document.getElementById('map'), {\r\n        center: {\r\n          lat: 25.0329636,\r\n          lng: 121.5654268\r\n        },\r\n        zoom: 13\r\n      });\r\n      for (var i = 0; i < data.length; i++) {\r\n        var str = {};\r\n        var place = {};\r\n\r\n        place.lat = parseFloat(data[i].Wgs84Y);\r\n        place.lng = parseFloat(data[i].Wgs84X);\r\n\r\n        str.map = map;\r\n        str.title = data[i].Name;\r\n        str.position = place;\r\n        str.icon = 'https://developers.google.com/maps/documentation/javascript/images/circle.png';\r\n        // console.log(place);\r\n        new google.maps.Marker(str);\r\n      }\r\n    }\r\n  }\r\n  /*https://github.com/pagekit/vue-resource*/\r\n  /*VUE RESOURCE*/\r\n})\r\n\r\n$(\"#gotop\").hide()\r\n$(function () {\r\n  $(window).scroll(function () {\r\n    if ($(this).scrollTop() > 1) {\r\n      $(\"#gotop\").fadeIn();\r\n    } else {\r\n      $(\"#gotop\").fadeOut();\r\n    }\r\n  });\r\n});\r\n$(\"#gotop\").on(\"click\", function (e) {\r\n  e.preventDefault();\r\n  $('html, body').animate({\r\n    scrollTop: $(\"html\").offset().top\r\n  }, 500);\r\n});",""]}