{"version":3,"sources":["all.js","map.js"],"names":["apiUrl","app","Vue","el","data","area","disasterData","newList","pageList","showinfo","countOfPage","currPage","totalPages","created","callData","computed","showPageList","vm","Math","floor","length","start","end","forEach","item","i","push","methods","$http","get","then","response","body","DataSet","NewDataSet","CASE_SUMMARY","status","getList","initMap","selectData","CaseLocationDistrict","setPage","idx","reSetPage","map","google","maps","Map","document","getElementById","center","lat","lng","zoom","str","place","parseFloat","Wgs84Y","Wgs84X","title","Name","position","icon","Marker","$","on","e","preventDefault","animate","scrollTop","offset","top"],"mappings":"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","file":"all.js","sourcesContent":["const apiUrl = 'https://tcgbusfs.blob.core.windows.net/blobfs/GetDisasterSummary.json'; //將apiUrl設定為常數不再變動。\r\n\r\nvar app = new Vue({\r\n  el: '#app',\r\n  data() {\r\n      return{\r\n        area: '全部',\r\n        disasterData: [], // 原始資料\r\n        newList: [], // 第一次整理後的資料\r\n        pageList: [], // 每頁的資料\r\n        showinfo: [],\r\n        countOfPage: 20, // 一頁顯示50筆\r\n        currPage: 0, // 當前頁數\r\n        totalPages: 0  // 總頁數的數字\r\n      }\r\n  },\r\n  created: function () {\r\n    //執行\r\n    this.callData()\r\n  },\r\n  computed: {\r\n    // 整理要顯示頁數的資料\r\n    showPageList: function () {\r\n      let vm =this;\r\n      vm.pageList=[];\r\n      // console.log(vm.newList,vm.pageList)\r\n      // 計算總頁數(無條件捨棄)=總資料/每頁顯示幾筆\r\n      vm.totalPages = Math.floor(vm.newList.length / vm.countOfPage);\r\n      var start = vm.currPage * vm.countOfPage;\r\n      var end = vm.currPage * vm.countOfPage + vm.countOfPage;\r\n      // console.log(start,end,vm.totalPages); 0,10,X\r\n      vm.newList.forEach(function (item, i) {\r\n        // 0~9筆資料\r\n        if(i>= start && i < end) {\r\n          vm.pageList.push(item)\r\n        }\r\n      })\r\n      // console.log(vm.newList, vm.pageList);\r\n      return vm.pageList;\r\n    }\r\n  },\r\n  methods: {\r\n    callData: function () {\r\n      var vm = this;\r\n\r\n      // GET /someUrl\r\n      this.$http.get(apiUrl).then(response => {\r\n        // 獲取災害資訊，取得資料\r\n        vm.disasterData = response.body.DataSet['diffgr:diffgram'].NewDataSet.CASE_SUMMARY;\r\n        vm.showinfo = response.status;\r\n        vm.getList();\r\n        initMap(vm.disasterData);\r\n      }, response => {\r\n        vm.showinfo = response.status;\r\n      });\r\n    },\r\n    // 整理剛得到的資料\r\n    getList: function () {\r\n      var vm = this;\r\n      vm.newList = [];\r\n      var selectData = vm.area;\r\n      // 篩選forEach寫法\r\n      if ( selectData === '全部'){\r\n        vm.newList = vm.disasterData;\r\n      }else{\r\n        // item是陣列的內容元素,i是索引\r\n        vm.disasterData.forEach(function (item, i) {\r\n          if (item.CaseLocationDistrict == selectData) {\r\n            vm.newList.push(item)\r\n          }\r\n        });\r\n      }\r\n      // console.log(newList);\r\n      return vm.newList;\r\n\r\n    },\r\n    // 控制上下頁的變換\r\n    setPage: function (idx) {\r\n      // idx就是html的n\r\n      let vm =this;\r\n      if (idx <= 0 || idx > vm.totalPages) {\r\n        return;\r\n      }\r\n      vm.currPage = idx;\r\n    },\r\n    // 起始顯示的頁數\r\n    reSetPage: function () {\r\n      let vm =this;\r\n      vm.currPage = 1;\r\n    }\r\n  }\r\n/*https://github.com/pagekit/vue-resource*/\r\n/*VUE RESOURCE*/\r\n})\r\n\r\n// Google Map API\r\n\r\nfunction initMap(data) {\r\n  // 設定中心點座標\r\n  var map = new google.maps.Map(document.getElementById('map'), {\r\n    center: {\r\n      lat: 25.0329636,\r\n      lng: 121.5654268\r\n    },\r\n    zoom: 13\r\n  });\r\n  for (var i = 0; i < data.length; i++) {\r\n    var str = {};\r\n    var place = {};\r\n\r\n    place.lat = parseFloat(data[i].Wgs84Y);\r\n    place.lng = parseFloat(data[i].Wgs84X);\r\n\r\n    str.map = map;\r\n    str.title = data[i].Name;\r\n    str.position = place;\r\n    str.icon = 'https://developers.google.com/maps/documentation/javascript/images/circle.png';\r\n    // console.log(place);\r\n    new google.maps.Marker(str);\r\n  }\r\n}\r\n\r\n$(\"#gotop\").on(\"click\", function (e) {\r\n  e.preventDefault();\r\n  $('html, body').animate({\r\n    scrollTop: $(\"html\").offset().top\r\n  }, 500);\r\n});",""]}